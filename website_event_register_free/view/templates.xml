<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        <template id="assets_backend" name="website_event_register_free assets" inherit_id="web.assets_backend">
            <xpath expr="." position="inside">
                <link rel="stylesheet" href="/website_event_register_free/static/src/css/website_event_register_free.css"/>
            </xpath>
        </template>

        <template id="free_registration_form">
            <form
                t-attf-action="/event/#{event.id}/register/register_free"
                method="post"
                class="table-responsive"
                t-if="'event_ticket_ids' not in event._fields or
                      not event.event_ticket_ids">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Ticket Type</th>
                            <th>Quantity</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Free</td>
                            <td>
                                <select
                                    name="tickets"
                                    class="form-control"
                                    t-if="event.seats_available or not event.seats_max">
                                    <t
                                        t-foreach="range(1, min(event.seats_available or 10, 10) + 1)"
                                        t-as="nb">
                                        <option t-esc="nb"/>
                                    </t>
                                </select>
                                <span
                                    t-if="not (event.seats_available or not event.seats_max)">
                                    No seats available
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <button
                    type="submit"
                    class="btn btn-primary btn-lg pull-right"
                    t-if="event.seats_available or not event.seats_max">
                    Register Now
                    <span class="fa fa-long-arrow-right"/>
                </button>
                <div class="clearfix"/>
                <hr/>
            </form>
        </template>

        <template id="event_description_full" inherit_id="website_event.event_description_full">
            <xpath expr="//div[@t-field='event.description']" position="before">
                <t t-call="website_event_register_free.free_registration_form"/>
            </xpath>
        </template>

        <!-- it might be a good idea to move this to an own module so that not
             every module dealing with whatever kind of subscription has to
             reinvent the wheel.
             This already is mostly a copy of website_sale.checkout /-->
        <template id="partner_register_form" name="Event registration">
            <t t-call="website.layout">
                <div id="wrap">
                <form t-attf-action="/event/#{event.id}/register/register_free" method="post" class="container">
                    <h1>Review the amount of tickets to register</h1>
                    <div class="row">
                        <div class="form-group col-lg-6">
                            <label class="control-label" for="name">Quantity</label>
                            <select
                                name="tickets"
                                class="form-control"
                                t-if="event.seats_available or not event.seats_max">
                                <t
                                    t-foreach="range(1, min(event.seats_available or 10, 10) + 1)"
                                    t-as="nb">
                                    <option t-esc="nb"
                                            t-att-selected="int(tickets) == nb and 'selected'"/>
                                </t>
                            </select>
                        </div>
                    </div>
                    <h1>Your Details</h1>
                    <div class="row">
                        <div t-attf-class="form-group col-lg-6 #{not validate('name') and 'has-error' or ''}">
                            <label class="control-label" for="name">Your Name</label>
                            <input type="text" name="name" class="form-control" t-att-value="post.get('name')" required="required" />
                        </div>
                        <div t-attf-class="form-group col-lg-6 #{not validate('parent_name') and 'has-error' or ''}">
                            <label class="control-label" for="parent_name">Your company / organisation</label>
                            <input type="text" name="parent_name" class="form-control" t-att-value="post.get('parent_name')" />
                        </div>
                    </div>
                    <div class="row">
                        <div t-attf-class="form-group col-lg-6 #{not validate('email') and 'has-error' or ''}">
                            <label class="control-label" for="email">Email</label>
                            <input type="email" name="email" class="form-control" t-att-value="post.get('email')" required="required" />
                        </div>
                        <div t-attf-class="form-group col-lg-6 #{not validate('phone') and 'has-error' or ''}">
                            <label class="control-label" for="phone">Phone</label>
                            <input type="text" name="phone" class="form-control" t-att-value="post.get('phone')" />
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg pull-right">Register <span class="fa fa-long-arrow-right"/></button>
                </form>
                </div>
            </t>
        </template>

        <template id="partner_register_confirm" name="Confirmation">
            <t t-call="website.layout">
                <div id="wrap" class="container">
                    <t t-call="website_event_register_free.confirm_message"/>
                </div>
            </t>
        </template>

        <template id="confirm_message"
                  name="Registration Succeeded Message">
            <div class="alert alert-success">
                <h3>Thank you <span t-esc="registration.name" />!</h3>
                Your free registration for
                <strong t-esc="registration.event_id.name" />
                succeeded!
            </div>
        </template>
     </data>
</openerp>
