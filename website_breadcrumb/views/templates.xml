<?xml version="1.0" encoding="utf-8"?>
<!-- © 2015 Grupo ESOC Ingeniería de Servicios, S.L.U. - Jairo Llopis
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html). -->

<openerp>
<data>

<template id="breadcrumb" name="Breadcrumb snippet">
    <t t-call="website_breadcrumb.breadcrumb-generator">
        <t t-set='include_self' t-value='False'/>
        <t t-set='revert_order' t-value='True'/>
    </t>
</template>

<template id="breadcrumb-generator" name="Breadcrumb snippet generator">
    <!-- Know if current page is in a menu item -->
    <t t-set="bc_item"
       t-value="request.env['website.menu']
                .search([('url', '=', request.httprequest.path)], limit=1)"/>

    <!-- If so, create the breadcrumbs -->
    <ol t-if="bc_item" class="breadcrumb">
        <!-- Parents -->
        <t t-set='steps' t-value="[i for i in bc_item.get_parents(revert_order, include_self)]"/>
        <t t-if='not revert_order'>
            <!-- Current -->
            <li class="active" t-esc="bc_item.name_get()[0][1]"/>
            <t t-set='steps' t-value='steps[:-1]'/>
        </t>
        <t t-if='revert_order'>
            <t t-set='steps' t-value='steps[1:]'/>
            <li>
              <a href="/">Home</a>
            </li>
        </t>
        <t t-foreach="steps" t-as="step">
            <li>
                <a t-att-href="step.url">
                    <t t-esc="step.name_get()[0][1]"/>
                </a>
            </li>
        </t>
        <!-- Current -->
        <t t-if='revert_order'>
            <li class="active" t-esc="bc_item.name_get()[0][1]"/>
        </t>
        <t t-if='not revert_order'>
            <li>
              <a href="/">Home</a>
            </li>
        </t>
    </ol>
</template>

</data>
</openerp>
